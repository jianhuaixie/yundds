<?php/** * ECTouch Open Source Project * ============================================================================ * Copyright (c) 2012-2014 http://ectouch.cn All rights reserved. * ---------------------------------------------------------------------------- * 文件名称：GroupbuyControoller.class.php * ---------------------------------------------------------------------------- * 功能描述：红包领取控制器 * ---------------------------------------------------------------------------- * Licensed ( http://www.ectouch.cn/docs/license.txt ) * ---------------------------------------------------------------------------- *//* 访问控制 */defined('IN_ECTOUCH') or die('Deny Access');class BonusController extends CommonController {    public function __construct() {        parent::__construct();        //if (ACTION_NAME == 'list') {           // $this->index();      //  }    }    /* ------------------------------------------------------ */    //-- 领取红包    /* ------------------------------------------------------ */    public function index() {		//$user_id =	$_SESSION['user_id']?0:$_SESSION['user_id'];		$url =  'http://'.$_SERVER['HTTP_HOST'].'/mobile';		if($_SESSION['user_id']){			$res = model('Bonus') -> add_bonus($_SESSION['user_id'],$_GET['bonus_sn']);			if($res == 1){				echo '<script>alert("优惠券领取成功");location.href="/mobile/index.php?m=default&c=user&a=my_bonus"</script>';			}else{				echo '<script>alert("'.$res.'");location.href="'.$url.'"</script>';			}		}else{		echo '<script>alert("请登陆后领取优惠券");location.href="'.$url.'/index.php?m=default&c=user&a=login"</script>';		}	}}